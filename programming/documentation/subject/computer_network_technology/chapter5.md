# 网络互联技术

## 网络互联概述

  + 网络互联技术是所有能在物理上和逻辑上实现不同网络相互连接的技术的总称，对应于ISO/OSI参考模型的各个层次。

  + “互联”和“互连”具有不同的含义：“网络互连”仅指将网络通过有线或无线传输介质在物理上连接在一起，而“网络互联”的含义还包括不同的网络之间在功能和应用上能够看起来像一个完整的网络一样，自由顺畅地运行。

  + 采用不同通信技术和运行协议的网络通常称为异构网络。

## 网际协议

  + IP概述

    - 网络层协议：ICMP，IGMP，ARP，IP。

    - IP网络采用路由器（Router）作为网络互联的中间设备，将不同的计算机网络互联起来，在网络层实现数据的路由和转发。

    - IP的特点：IP是面向无连接的，不可靠的分组传输协议。IP屏蔽了数据链路层和物理层的差异，使得数据的传输和转发更加方便。IP是点对点式网络通信协议。

  + IPv4协议报文格式

    - IPv4式第四版IP协议，IP协议是Internet的主要协议之一。

    - ![IP数据报格式](./resources/ip_structure.png)

    - 版本：定义了IP协议的版本。

    - 首部长度：4bit的字段定义了分组的首部长度，最多15，单位4B，所以最长60B。

    - 服务类型：定义了一组区分服务用于表示分组的优先级。当路由器需要丢弃一些数据时，优先级低的将会首先被丢弃。

    - 总长度：16bit。故IPv4分组总长度的上限值是65536位。

    - 标识：确定了分组的唯一性。这样使得数据报被分片后，在到达终点时能够根据标识号将同一个数据报的分片重新组装成一个数据报。

    - ![IP标志位](./resources/ip_flag.png)

      - 第一位保留（未用），第二位表示不分片，第三位表示还有分片。

    - 分片偏移：13bit。表示该分片在原始数据报中的偏移量，以8B为单位。

    - 生存时间：控制数据报所经过的最大跳数（路由器），每经过一个路由器，这个字段数值都减1，当值为0时，路由器就丢弃这个数据报。

    - 协议：8bit。定义了使用IPv4服务的高层协议。1表示ICMP，2表示IGMP，6表示TCP，17表示UDP，89表示OSPF。

    - 检验和：检验IP数据报首部。

    - 源地址：32bit。源点的IP地址。

    - 目的地址：32bit。终点的IP地址。
